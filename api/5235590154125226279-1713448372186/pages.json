[{"kind":"blogger#pageList","items":[{"kind":"blogger#page","id":"7018173462225735002","blog":{"id":"5235590154125226279"},"published":"2020-03-26T20:02:00+08:00","updated":"2020-03-26T20:02:43+08:00","url":"http://program-think.blogspot.com/p/about.html","selfLink":"https://www.googleapis.com/blogger/v3/blogs/5235590154125226279/pages/7018173462225735002","title":"关于","content":"俺叫“编程随想”（当然是笔名）<br />\n真名是啥，暂不公开（以免被跨省追捕）<br />\n<br />\n俺的邮箱，欢迎来信<br />\n<a href=\"mailto:program.think@gmail.com\">program.think@gmail.com</a><br />\n（给俺写信，强烈建议用【国外】邮箱；如果用国内邮箱，容易被墙，俺很可能收不到）<br />\n<br />\n俺的 Twitter，欢迎 Follow<br />\n<a href=\"https://twitter.com/programthink\">https://twitter.com/programthink</a><br />\n<br />\n俺的收藏<br />\n<a href=\"https://github.com/programthink\">https://github.com/programthink</a><br />\n","author":{"id":"11741356469378252621","displayName":"编程随想","url":"https://www.blogger.com/profile/11741356469378252621","image":{"url":"//1.bp.blogspot.com/-_5va5DafROs/VtcrFXMaY_I/AAAAAAAABU4/lQWoB9z4jaI/s35/Thinker.jpg"}},"etag":"\"dGltZXN0YW1wOiAxNTg1MjI0MTYzMTExCm9mZnNldDogMjg4MDAwMDAK\""},{"kind":"blogger#page","id":"7458991612391696286","blog":{"id":"5235590154125226279"},"published":"2019-02-03T14:29:00+08:00","updated":"2019-02-03T14:29:06+08:00","url":"http://program-think.blogspot.com/p/options.html","selfLink":"https://www.googleapis.com/blogger/v3/blogs/5235590154125226279/pages/7458991612391696286","title":"界面配置选项","content":"<div id=\"options-area\" style=\"display:none;\"><br />\n<div id=\"about-cookies\"><h2>★关于“保存 Cookie”的说明</h2><br />\n<h3>◇为啥要保存 cookie？</h3><br />\n&#12288;&#12288;俺这个博客架设在 Google 的 Blogspot 博客平台上。该平台只提供客户端页面的定制功能，【不提供】服务器端的存储功能。如果要保存读者的配置选项，俺只能保存到浏览器的 cookie 中。<br />\n&#12288;&#12288;由于“浏览器 cookie”会导致隐私方面的担忧，所以俺事先征询你的同意。<br />\n<br />\n<h3>◇俺用 cookie 存储配置参数的格式</h3><br />\n&#12288;&#12288;浏览器的 cookie 是跟【具体域名】绑定滴。每个网站只能读写【自己所在域名】下的 cookie 信息。<br />\n&#12288;&#12288;为了便于管理，俺会把所有的配置参数都保存在名为【 <b>options</b> 】的 cookie 中。如果你想要清除所有的配置参数，只需删除该 cookie 既可。<br />\n&#12288;&#12288;提醒一下：<br />\n&#12288;&#12288;在俺博客对应的 <a href=\"https://program-think.blogspot.com/\">program-think.blogspot.com</a> 域名下，还有另外几个 cookie——那些是 Google 的博客平台（blogspot）保存滴，跟俺【没】啥关系。<br />\n<br />\n<h3>◇可能导致 cookie 失效的原因</h3><br />\n<b>原因1——浏览器的“隐私模式”</b><br />\n如果你使用“隐私模式”浏览俺的博客，当浏览器关闭之后，所有域名下的 cookie 都会消失。<br />\n解决方法：<br />\n（除非你退出“隐私模式”，否则暂时没有太好的办法）<br />\n俺正在考虑提供另一种 cookie 替代方式。等啥时候有空了，会开发出来。<br />\n<br />\n<b>原因2——某些安全扩展</b><br />\n有些浏览器的安全扩展会禁用 cookie，从而导致本页面的保存功能失效。<br />\n解决方法：<br />\n把俺博客的域名（<a href=\"https://program-think.blogspot.com/\">program-think.blogspot.com</a>）添加到这些扩展的【白名单】中。（也就是说：允许俺博客这个站点存储 cookie）。<br />\n<br />\n<hr>刚才花了点口水说明了 cookie 的相关情况，现在言归正传：<br />\n如果你同意俺保存 cookie，请勾选如下的复选框进行确认（勾选后，各个配置项会自动显现）；<br />\n如果你不允许保存 cookie，则无法配置任何选项参数（即使配置了也没地方保存）。<br />\n</div><!-- about-cookies end --><br />\n<div style=\"font-size:125%;font-weight: bold;\"><input id=\"allow-cookies\" type=\"checkbox\"/>同意使用 cookie 来保存本博客的配置参数</div><br />\n<div id=\"widgets-area\" style=\"display:none;\"><hr/><!-- article --><br />\n<a name=\"article\"></a><br />\n<h2>正文区</h2><a name=\"article-font-size\"></a><br />\n<h3>◇字体</h3><br />\n<span id=\"article_font-size-value\"></span> <div id=\"article_font-size\" class=\"slider font\"></div><a name=\"article-inner-index\"></a><br />\n<h3>◇文章目录</h3><br />\n<input id=\"article_inner-index\" type=\"checkbox\"/>显示“文章目录”<br />\n<blockquote style=\"background-color:#DDD;\">说明：<br />\n启用该选项之后，会在每篇博文的标题下面自动生成此文的内部目录结构，方便你直接点击跳转到某个博文的章节。<br />\n此功能对【章节很多】的长篇博文尤其方便。</blockquote><br />\n<hr/><!-- comments --><br />\n<a name=\"comments\"></a><br />\n<h2>评论区</h2><a name=\"comments-font-size\"></a><br />\n<h3>◇字体</h3><br />\n<span id=\"comments_font-size-value\"></span><br />\n<div id=\"comments_font-size\" class=\"slider font\"></div><a name=\"comments-limit-height\"></a><br />\n<h3>◇自动截断长篇评论</h3><br />\n<input id=\"comments_limit-height\" type=\"checkbox\"/>自动截断长篇评论<br />\n<blockquote style=\"background-color:#DDD;\">说明：<br />\n有些评论的内容太长，会导致整个页面拉得很长。此时，用鼠标滚轮会比较费劲。<br />\n启用该选项之后，会自动截断长篇的评论。当你需要看该评论的全文时，点击评论下面的“展开评论全文”链接，既可。</blockquote><br />\n<hr/><!-- tweets --><br />\n<a name=\"tweets\"></a><br />\n<h2>【最新】评论区</h2><a name=\"tweets-font-size\"></a><br />\n<h3>◇字体</h3><br />\n<span id=\"tweets_font-size-value\"></span><br />\n<div id=\"tweets_font-size\" class=\"slider font\"></div><a name=\"tweets-init\"></a><br />\n<h3>◇初始化</h3><br />\n初始加载的评论条数：<span id=\"tweets_init-num-value\"></span> 条<br />\n<div id=\"tweets_init-num\" class=\"slider\"></div><a name=\"tweets-auto-load\"></a><br />\n<h3>◇自动刷新</h3><br />\n<input id=\"tweets_auto-load\" type=\"checkbox\"/>开启“自动刷新”<br />\n<blockquote style=\"background-color:#DDD;\">说明：<br />\n启用自动刷新之后，JS 脚本每隔 N 分钟会去检查一下：本博客是否有新的评论。<br />\n如果有的话就把新的评论插入到“最新评论区”的上方。</blockquote><br />\n自动刷新的时间间隔：<span id=\"tweets_auto-load-timeout-value\"></span> 分钟<br />\n<div id=\"tweets_auto-load-timeout\" class=\"slider\"></div><br />\n<hr/><!-- side-toolbar --><br />\n<a name=\"side-toolbar\"></a><br />\n<h2>悬浮工具条</h2><br />\n<input id=\"side-toolbar_show\" type=\"checkbox\"/>显示工具条<br />\n<br />\n<input id=\"side-toolbar_drag\" type=\"checkbox\"/>工具条支持拖拽<br />\n<blockquote style=\"background-color:#DDD;\">说明：<br />\n每次拖动操作完成后，会自动把“工具条的位置”保存到 cookie 中。</blockquote><br />\n<hr/><center class=\"save-options\"><a>保存配置到 cookie</a> <span title=\"过了这个时间段，你保存的 cookie 会失效（自动消失）\">cookie 保存期限：</span><select id=\"cookie-expire-days\" title=\"请选择【存储期限】\"><option value=\"\" selected>【请选择】</option><option value=\"30\">一个月</option><option value=\"90\">三个月</option><option value=\"183\">半年</option><option value=\"365\">一年</option><option value=\"1095\">三年</option></select></center><hr/></div><!-- widgets-area end --><br />\n</div><!-- options-area end --><br />\n<br />\n<noscript><br />\n<center><b>你的浏览器不支持 JavaScript/JS 脚本，无法进行界面选项的配置 :(</b></center><br />\n<style type=\"text/css\">\n.post-body #config-area {\n  display: none !important;\n}\n</style><br />\n<br />\n</noscript><br />\n<br />\n<style type=\"text/css\">\n\nh1.post-title,\nh1.entry-title {\n  text-align: center;\n}\n.post-body h2 {\n  font-size: 160%;\n  padding-left: 0px;\n}\n.post-body h3{\n  padding-left: 0px;\n}\n\n.post-body blockquote {\n  margin: 0px !important;\n}\n\n.save-options a {\n  font-size: 30px;\n  font-weight: bold;\n}\n.save-options span {\n  font-size: 24px;\n  font-weight: bold;\n  margin-left: 50px;\n}\n</style><br />\n<br />\n<br />\n<script type=\"text/javascript\">\n\njQuery(function($)\n{\n  var mapConfig = loadConfig();\n\n  function createFontSizeSlider(sId)\n  {\n    var sConfigValue = mapConfig[sId];\n\n    sId = sId.replace(/\\./g, \"_\");\n    $(\"#\"+sId).slider({\n      slide: function(event, ui)\n              {\n                $(\"#\"+sId+\"-value\").html(\"字体大小：\"+ui.value+\"%\")\n                    .css(\"font-size\", ui.value+\"%\");\n              },\n      change: function(event, ui)\n              {\n                $(\"#\"+sId+\"-value\").html(\"字体大小：\"+ui.value+\"%\")\n                    .css(\"font-size\", ui.value+\"%\");\n              },\n      value: 0,\n      min: 50,\n      max: 200,\n      step: 5\n    });\n    $(\"#\"+sId).slider({ value: sConfigValue });\n  }\n\n  function createNumberSlider(sId, nMin, nMax, nStep)\n  {\n    var sConfigValue = mapConfig[sId];\n\n    sId = sId.replace(/\\./g, \"_\");\n    $(\"#\"+sId+\"-value\").css(\"font-weight\",\"bold\");\n    $(\"#\"+sId).slider({\n      slide: function(event, ui)\n              {\n                $(\"#\"+sId+\"-value\").html(ui.value);\n              },\n      change: function(event, ui)\n              {\n                $(\"#\"+sId+\"-value\").html(ui.value);\n              },\n      value: -1,\n      min: nMin,\n      max: nMax,\n      step: nStep\n    });\n    $(\"#\"+sId).slider({ value: sConfigValue });\n  }\n\n  function createDropdown(sId)\n  {\n    var sConfigValue = mapConfig[sId];\n    sId = sId.replace(/\\./g, \"_\");\n    $(\"#\"+sId).val(sConfigValue);\n  }\n\n  function createCheckbox(sId)\n  {\n    var sConfigValue = mapConfig[sId];\n    sId = sId.replace(/\\./g, \"_\");\n    $(\"#\"+sId).prop(\"checked\", (\"true\"==sConfigValue) ? true: false);\n  }\n\n  function onClickAllowCookies()\n  {\n    var bAllow = $(\"#allow-cookies\").is(\":checked\");\n    $(\"#about-cookies\").css(\"display\", bAllow ? \"none\" : \"block\");\n    $(\"#widgets-area\").css(\"display\", bAllow ? \"block\" : \"none\");\n    if(bAllow)\n    {\n      if(\"#\" == location.hash)\n      {\n        $(\"h1.post-title\").scrollTo(\"fast\");\n      }\n      else\n      {\n        var sHash = location.hash;\n        location.hash = \"#\";\n        location.hash = sHash;\n      }\n    }\n    else\n    {\n      $(\"h1.post-title\").scrollTo(\"fast\");\n    }\n  }\n\n  function init()\n  {\n    // allow cookies checkbox\n    $(\"#allow-cookies\").prop(\"checked\", hadConfig())\n                       .click(function() { onClickAllowCookies() });\n    onClickAllowCookies();\n\n    // Widgets\n    $(\".slider\").css(\"width\", \"80%\").css(\"margin-top\", \"15px\");\n\n    // Article\n    createFontSizeSlider(\"article.font-size\");\n    createCheckbox(\"article.inner-index\");\n\n    // Comments\n    createFontSizeSlider(\"comments.font-size\");\n    createCheckbox(\"comments.limit-height\");\n\n    // Tweets\n    createFontSizeSlider(\"tweets.font-size\");\n    createNumberSlider(\"tweets.init-num\", 10, 100, 5);\n    createCheckbox(\"tweets.auto-load\");\n    createNumberSlider(\"tweets.auto-load-timeout\", 1, 60, 1);\n\n    $(\"#tweets_auto-load\").click(\n      function() { $(\"#tweets_auto-load-timeout\").slider(\"option\", \"disabled\", !$(this).is(\":checked\")) }\n    );\n    $(\"#tweets_auto-load-timeout\").slider(\"option\", \"disabled\", !$(\"#tweets_auto-load\").is(\":checked\"));\n\n    // Side toolbar\n    createCheckbox(\"side-toolbar.show\");\n    createCheckbox(\"side-toolbar.drag\");\n\n    $(\"#side-toolbar_show\").click(\n      function() { $(\"#side-toolbar_drag\").prop(\"disabled\", !$(this).is(\":checked\")) }\n    );\n    $(\"#side-toolbar_drag\").prop(\"disabled\", !$(\"#side-toolbar_show\").is(\":checked\"));\n\n    // Expire days\n    $(\"#cookie-expire-days\").tooltip({\n      open: function(event, ui)\n      {\n        delayRun(function() { $(ui.tooltip).hide(\"fade\") }, 5000);\n      }\n    }).val((new Cookie(\"expire_days\")).load());\n\n    // Save\n    $(\".save-options a\").attr(\"href\", \"javascript:;\").click(\n      function()\n      {\n        if(!$(\"#allow-cookies\").is(\":checked\"))\n        {\n          alert(\"请先勾选本页面开头 '同意使用 cookie 来保存本博客的配置参数' 的复选框\");\n          return;\n        }\n\n        var mapConfig = loadConfig();\n\n        var arrSliderItems = [\n          \"article.font-size\",\n          \"comments.font-size\",\n          \"tweets.font-size\",\n          \"tweets.init-num\",\n          \"tweets.auto-load-timeout\"\n        ];\n        for(var i=0; i<arrSliderItems.length; i++)\n        {\n          var sSliderId = arrSliderItems[i].replace(/\\./g, \"_\");\n          mapConfig[arrSliderItems[i]] = $(\"#\"+sSliderId).slider(\"option\", \"value\");\n        }\n\n        var arrDropdownItems = [ \"comments.bbcode-img\" ];\n        for(var i=0; i<arrDropdownItems.length; i++)\n        {\n          var sDropdownId = arrDropdownItems[i].replace(/\\./g, \"_\");\n          mapConfig[arrDropdownItems[i]] = $(\"#\"+sDropdownId).val();\n        }\n\n        var arrCheckboxItems = [\n          \"article.inner-index\",\n          \"comments.limit-height\",\n          \"tweets.auto-load\",\n          \"side-toolbar.show\",\n          \"side-toolbar.drag\"\n        ];\n        for(var i=0; i<arrCheckboxItems.length; i++)\n        {\n          var sCheckboxId = arrCheckboxItems[i].replace(/\\./g, \"_\");\n          mapConfig[arrCheckboxItems[i]] = $(\"#\"+sCheckboxId).is(\":checked\") ? \"true\" : \"false\";\n        }\n\n        var nExpireDays = parseInt($(\"#cookie-expire-days\").val());\n        if(isNaN(nExpireDays))\n        {\n          $(\"#cookie-expire-days\").tooltip(\"open\");\n          showBottomTip(\"<b style='color:red;'>保存之前，请先选择 cookie 的存储期限</b>\", 8000);\n          return;\n        }\n        (new Cookie(\"expire_days\")).saveInt(nExpireDays, nExpireDays);\n        saveConfig(mapConfig);\n        isTest() && (new Cookie(\"blog_admin\")).saveInt(1);\n        showBottomTip(\"相关配置已经保存到 cookie 中。\", 3000);\n      }\n    );\n\n    $(\"#options-area\").show();\n    (location.hash.length > 1)\n      && $(\"a[name=\"+location.hash.substr(1)+\"]\").scrollTo(\"fast\");\n  }  // init() end\n\n  $(document).ready(\n    function()\n    {\n      try\n      {\n        init();\n      }\n      catch(err)\n      {\n        showBottomTip(\"<b>界面初始化出错！</b>\", 0);\n        reportError(\"init: Catch exception:\\n\" + err);\n      }\n    }\n  );\n});\n</script>","author":{"id":"11741356469378252621","displayName":"编程随想","url":"https://www.blogger.com/profile/11741356469378252621","image":{"url":"//1.bp.blogspot.com/-_5va5DafROs/VtcrFXMaY_I/AAAAAAAABU4/lQWoB9z4jaI/s35/Thinker.jpg"}},"etag":"\"dGltZXN0YW1wOiAxNTQ5MTc1MzQ2MjI4Cm9mZnNldDogMjg4MDAwMDAK\""},{"kind":"blogger#page","id":"1830749735977029907","blog":{"id":"5235590154125226279"},"published":"2019-01-01T13:32:00+08:00","updated":"2019-01-01T13:32:32+08:00","url":"http://program-think.blogspot.com/p/search.html","selfLink":"https://www.googleapis.com/blogger/v3/blogs/5235590154125226279/pages/1830749735977029907","title":"博客站内搜索","content":"<table id=\"search-conditions\"><tr><td>搜索关键词：</td><td><input id=\"search-keywords\" type=\"text\" size=\"32\" maxlength=\"64\" title=\"请输入搜索关键词\"/></td><td style=\"font-size:80%;\"><span id=\"keywords-tip\"></span></td></tr>\n<tr><td>关键词位于：</td><td><select id=\"search-scope\"><option value=\"all\">（博文或评论的）任何位置</option><option value=\"article-content\">博文内容</option><option value=\"article-title\">博文标题</option><option value=\"comment-content\">评论内容</option><option value=\"comment-author\">评论作者的名称</option><option value=\"comment-author-url\">评论作者的网址（仅限【登录过的评论作者】）</option></select></td><td style=\"font-size:80%;\">限定“搜索关键字”所在的位置</td></tr>\n<tr><td>时间范围：</td><td><input type=\"text\" id=\"min-date\" size=\"10\" title=\"开始日期\" readonly>　—　<input type=\"text\" id=\"max-date\" size=\"10\" title=\"结束日期\" readonly></td><td style=\"font-size:80%;\">只搜索在该时间段内创建的内容（博文/评论）<br />\n“日期选择框”限制了日期的“可输入范围”：<br />\n必须在 2009-01-15（开博日）之后，今天之前（含）<br />\n<b>（如果搜索范围含【评论】，时间跨度越大，搜索越慢）</b></td></tr>\n<tr><td>&nbsp;</td><td align=\"right\"><span style=\"font-size:125%;font-weight:bold;\"><a id=\"start-search\" href=\"javascript:;\">开始搜索</a><a id=\"stop-search\" href=\"javascript:;\" style=\"display:none;\">中止搜索</a></span></td><td>&nbsp;</td></tr>\n</table><div id=\"search-message\"><noscript><b>你的浏览器不支持 JavaScript/JS 脚本, 无法使用“站内搜索”功能 :(</b></noscript><br />\n<div class=\"complete\"></div><div class=\"article\"></div><div class=\"comment\"></div></div><div id=\"search-loading\" style=\"display:none;\"><div id=\"progress-bar\"><div id=\"progress-label\"></div></div></div><hr/><!-- results --><br />\n<div id=\"search-results\"><div class=\"articles\"></div><div class=\"admin-comments\"></div><div class=\"reader-comments\"></div></div><br />\n<style type=\"text/css\">\n\nh1.post-title,\nh1.entry-title {\n  text-align: center;\n}\n\n#search-message,\n#search-loading,\n#search-results {\n  padding: 12px 0px;\n}\n\n/*-- Search conditions --*/\ntable#search-conditions {\n  display: none;\n  border-spacing: 0px;\n  border-collapse: separate;\n}\ntable#search-conditions td {\n  padding: 8px 12px;\n}\n\n#search-conditions #min-date,\n#search-conditions #max-date {\n  text-align: center;\n}\n\n/*-- Search message --*/\n#search-message {\n}\n\n/*-- Search loading --*/\n#search-loading #progress-label {\n  position: absolute;\n  left: 50%;\n  margin-left: -20px;\n  top: 50%;\n  margin-top: -10px;\n  font-size: 20px;\n  font-weight: bold;\n}\n\n/*-- Search results --*/\n#search-results .article-block,\n#search-results .comment-block {\n  padding: 12px 0px;\n}\n\n#search-results .highlight {\n  color: Red;\n  font-weight: bold;\n}\n\n#search-results a[target=\"_blank\"] {\n  background: none !important;\n  padding-right: 0px;\n}\n\n/*-- Article --*/\n#search-results .article-block .article-header {\n  font-size: 125%;\n  font-weight: bold;\n  text-align: center;\n}\n#search-results .article-block .article-toolbar span {\n  padding-left: 20px;\n}\n#search-results .article-block .article-toolbar .post-timestamp {\n  color: Gray;\n}\n#search-results .article-block .article-toolbar .tags a {\n  padding-right: 8px;\n}\n\n/*-- Comment --*/\n#search-results .comment-block {\n  font-style: normal;\n  font-size: 100%;\n}\n#search-results .comment-block .comment-header img.avatar {\n  width: 36px;\n  height: 36px;\n  max-width: 36px;\n  max-height: 36px;\n  border: none;\n}\n#search-results .comment-block .comment-header cite.author {\n  font-size: 125%;\n  font-weight: bold;\n  margin: 0px 18px;\n}\n#search-results .comment-block .comment-header cite.author.blog-author {\n  border-bottom: 2px solid !important;\n}\n#search-results .comment-block .comment-header .datetime {\n  font-size: 80%;\n  font-style: italic;\n  color: Gray;\n}\n\n#search-results .comment-block .comment-article {\n  font-size: 110%;\n  padding: 6px 0px;\n}\n</style><br />\n<br />\n<br />\n<script type=\"text/javascript\">\n\nfunction Article(json)\n{\n  this.sId = json.id.$t.replace(/^.+?\\.post\\-(\\d+)$/, \"$1\");\n  this.sUrl = \"\";\n  this.sTitle = json.title.$t;\n  this.sContent = \"\";\n  this.dtCreate = null;\n  this.sCommentInfo = \"\";\n  this.arrTags = [];\n\n  if(\"content\" in json) { this.sContent = json.content.$t }\n  else if (\"summary\" in json) { this.sContent = json.summary.$t + \"......\" }\n  this.sContent = this.sContent.htmlTrimTag().replace(/\\n{3,}/g, \"\\n\\n\").trim();\n\n  var article = this;\n  function _procLink(i, link)\n  {\n    if(\"alternate\" == link.rel) { article.sUrl = link.href }\n    else if(\"replies\" == link.rel) { article.sCommentInfo = link.title }\n  }\n  $.each(json.link, _procLink);\n\n  this.dtCreate = Date.parseISO(json.published.$t);\n\n  function _procCategory(i, category)\n  {\n    var sName = category.term, sUrl = \"/search/label/\" + encodeURIComponent(sName);\n    article.arrTags.push({ sName:sName, sUrl:sUrl });\n  }\n  $.each(json.category, _procCategory);\n}  // Article() end\n\nArticle.prototype.show = function($article_block, options)\n{\n  options = options || {};\n\n  {\n    var sTitle = this.sTitle;\n    (\"highlightTitle\" in options) && (sTitle = highlightSearchKeywords(sTitle, options.highlightTitle));\n\n    var sUrl = this.sUrl;\n    (\"keywords\" in options) && (sUrl += \"?q=\" + encodeURIComponent(options.keywords.join(\" \")));\n    (\"scope\" in options) && (sUrl += \"&scope=\" + options.scope);\n\n    $article_block.children(\".article-header\").append(\"《<a href='\" + sUrl + \"'>\" + sTitle + \"</a>》\");\n  }\n  {\n    var $toolbar = $article_block.children(\".article-toolbar\");\n    $toolbar.append(\"<span class='post-timestamp'>\" + this.dtCreate.format(\"%Y年%m月%d日\") + \"</span>\");\n    $toolbar.append(\"<span><a href='\" + this.sUrl + \"#comments'>\" + this.sCommentInfo + \"</a></span>\");\n\n    var sTagsHtml = \"\";\n    $.each(this.arrTags, function(i, tag){ sTagsHtml += \"<a href='\" + tag.sUrl + \"'>\" + tag.sName + \"</a>\" });\n    $toolbar.append(\"<span class='tags'>标签：\" + sTagsHtml + \"</span>\");\n  } // toolbar\n\n  var nExtLen = 100;\n  if(\"highlightContent\" in options)\n  {\n    var arrKeywords = options.highlightContent, arrFindPos = [], mapPreview = {};\n    for(var n=0; n<arrKeywords.length; n++)\n    {\n      var sKeyword = arrKeywords[n];\n      var nFindPos = this.sContent.search( keywordToRegexp(sKeyword) );\n      if(-1 == nFindPos) { continue }\n\n      var nBegin = ( (nFindPos > nExtLen) ? (nFindPos - nExtLen) : 0 );\n      var nEnd = nFindPos + sKeyword.length + nExtLen;\n      (nEnd > this.sContent.length) && (nEnd = this.sContent.length - 1);\n      var sPreview = highlightSearchKeywords(this.sContent.substring(nBegin, nEnd), [sKeyword]);\n\n      arrFindPos.push(nFindPos);\n      mapPreview[nFindPos] = [sKeyword, sPreview];\n    }\n    var $preview = $article_block.children(\".article-preview\");\n    arrFindPos.sort();\n    $.each(arrFindPos,\n           function(i, nPos)\n           {\n             var sHtml = \"关键字：\" + mapPreview[nPos][0]\n                 + \"\\n<blockquote\"+\">......\" + mapPreview[nPos][1] + \"......</\"+\"blockquote>\";\n             $preview.append(sHtml.replace(/\\n/g, \"<br\"+\"/>\"));\n           });\n  }\n  else\n  {\n    var sContent = this.sContent.substr(0, nExtLen * 2).replace(/\\n/g, \"<br\"+\"/>\");\n    $article_block.children(\".article-preview\").append(\"<blockquote\"+\">\" + sContent + \"......</\"+\"blockquote>\");\n  }\n\n  $article_block.find(\"div a\").attr(\"target\", \"_blank\");\n}  // show() end\n\n\njQuery(function($)\n{\n  // Module variables\n  var m_oSearchConds = {};\n  var m_sArticleTaskId = \"\";\n  var m_sCommentTaskId = \"\";\n\n  var m_nMaxMatchArticle = 50;\n  var m_nTotalArticle = 0;\n  var m_nLoadedArticle = 0;\n  var m_nMatchedArticle = 0;\n\n  var m_nMaxMatchComment = 100;\n  var m_nTotalComment = 0;\n  var m_nLoadedComment = 0;\n  var m_nMatchedComment = 0;\n\n\n  function parseKeywordCond()\n  {\n    var str = $(\"#search-keywords\").val().toLowerCase();\n    if(!str)\n    {\n      $(\"#search-keywords\").tooltip(\"open\");\n      showBottomTip(\"请先输入“搜索关键字”！\", 8000);\n      return false;\n    }\n\n    if(\"comment-author-url\" == m_oSearchConds.sScope)\n    {\n      var oUrl = new Url(str);\n      if(!oUrl.bValid)\n      {\n        showBottomTip(\"输入的“搜索关键字”【不是】合法的网址！\", 8000);\n        return false;\n      }\n      m_oSearchConds.arrInclude = [str];\n      m_oSearchConds.arrExclude = [];\n      return true;\n    }\n\n    var sValidChar = \"\\\\w\\\\u4E00-\\\\u9FFF\\\\u2000-\\\\u206F\\\\u3000-\\\\u303F\\\\uFF00-\\\\uFFEF\\\\.\";\n    var reExclude = new RegExp(\"(?:^|\\\\s)(?:-([\" + sValidChar + \"]+)|-\\\"([\" + sValidChar + \"\\\\s]+)\\\")(?:\\\\s|$)\", \"\");\n    var reInclude = new RegExp(\"(?:^|\\\\s)(?:([\" + sValidChar + \"]+)|\\\"([\" + sValidChar + \"\\\\s]+)\\\")(?:\\\\s|$)\", \"\");\n\n    m_oSearchConds.arrExclude = [];\n    function _procExclude(sMatch, s1, s2)\n    {\n      s1 && m_oSearchConds.arrExclude.push(s1);\n      s2 && m_oSearchConds.arrExclude.push(s2);\n      return \" \";\n    }\n    while(true)\n    {\n      var sOld = str;\n      str = str.replace(reExclude, _procExclude);\n      if(str == sOld) { break }\n    }\n\n    m_oSearchConds.arrInclude = [];\n    function _procInclude(sMatch, s1, s2)\n    {\n      s1 && m_oSearchConds.arrInclude.push(s1);\n      s2 && m_oSearchConds.arrInclude.push(s2);\n      return \" \";\n    }\n    while(true)\n    {\n      var sOld = str;\n      str = str.replace(reInclude, _procInclude);\n      if(str == sOld) { break }\n    }\n    m_oSearchConds.arrInclude.sort(function(a, b) { return b.length - a.length });\n\n    str = str.trim();\n    str && showBottomTip(\"搜索关键字包含无效字符：<b style='color:Red;'>\" + str + \"</b>\", 8000);\n    return !str;\n  }  // parseKeywordCond() end\n\n  function parseDateCond()\n  {\n    m_oSearchConds.dtMin = Date.parseISO($(\"#min-date\").val());\n    m_oSearchConds.dtMax = Date.parseISO($(\"#max-date\").val() + \"T23:59:59\");\n    if(m_oSearchConds.dtMin > m_oSearchConds.dtMax)\n    {\n      showBottomTip(\"“时间范围”的设置有误！——“起始日期”必须小于等于“结束日期”\", 5000);\n      return false;\n    }\n    return true;\n  }\n\n  function initArticleTotal()\n  {\n    $.ajax({\n      url: Url.getFeedUrlPrefix() + \"/posts/summary?alt=json&max-results=1\",\n      dataType: \"json\",\n      success: function(json) { m_nTotalArticle = parseInt(json.feed.openSearch$totalResults.$t) },\n      timeout: 1000*32\n    });\n  }\n\n  function loadArticles(sTaskId, nIndex)\n  {\n    var sFeedUrl = Url.getFeedUrlPrefix() + \"/posts/\"\n      + ( (\"article-title\" == m_oSearchConds.sScope)\n        ? \"summary?alt=json&max-results=\" + 80\n        : \"full?alt=json&max-results=\" + 20 )\n      + \"&q=\" + encodeURIComponent($(\"#search-keywords\").val())\n      + \"&start-index=\" + nIndex;\n\n    $.ajax({\n      url: sFeedUrl,\n      dataType: \"json\",\n      success: function(json) { procArticles(sTaskId, json, nIndex) },\n      error: function(xhr, sType) { reportHttpError(\"搜索博文出错\", xhr, sType) },\n      timeout: 1000*64\n    });\n  }\n\n  function matchArticle(article)\n  {\n    var str = \"\";\n    if(\"all\" == m_oSearchConds.sScope) { str = article.sTitle + \"\\n\" + article.sContent }\n    else if(\"article-content\" == m_oSearchConds.sScope) { str = article.sContent }\n    else if(\"article-title\" == m_oSearchConds.sScope) { str = article.sTitle }\n\n    for(var i=0; i<m_oSearchConds.arrInclude.length; i++)\n    {\n      var regex = keywordToRegexp(m_oSearchConds.arrInclude[i]);\n      if(str.search(regex) == -1) { return false }\n    }\n\n    for(var i=0; i<m_oSearchConds.arrExclude.length; i++)\n    {\n      var regex = keywordToRegexp(m_oSearchConds.arrExclude[i]);\n      if(str.search(regex) != -1) { return false }\n    }\n\n    return true;\n  }  // matchArticle() end\n\n  function procArticles(sTaskId, json, nIndex)\n  {\n    if(m_sArticleTaskId != sTaskId) { return }  // User canceled\n    if(!(\"entry\" in json.feed))  // Not more data\n    {\n      m_sArticleTaskId = \"\";\n      m_oSearchConds.sScope.startsWith(\"article\") && stopSearch(false);\n      return;\n    }\n\n    var $container = $(\"#search-results .articles\");\n    for(var n=0; n<json.feed.entry.length; n++)\n    {\n      var article = new Article(json.feed.entry[n]);\n      m_nLoadedArticle += 1;\n\n      if(m_oSearchConds.dtMin && article.dtCreate < m_oSearchConds.dtMin)\n      {\n        stopSearch(false);\n        return;\n      }\n      if(m_oSearchConds.dtMax && article.dtCreate > m_oSearchConds.dtMax) { continue }\n      if(!matchArticle(article)) { continue }\n      m_nMatchedArticle += 1;\n\n      var sHtml = \"<\"+\"div class='article-block' id='article-\" + article.sId + \"'>\"\n                + \"<\"+\"div class='article-header'/>\"\n                + \"<\"+\"div class='article-toolbar'/>\"\n                + \"<\"+\"div class='article-preview'/>\"\n                + \"</\"+\"div>\";\n      $container.append(sHtml);\n      var opts = { scope: m_oSearchConds.sScope, keywords: m_oSearchConds.arrInclude };\n      if(\"all\" == m_oSearchConds.sScope)\n      {\n        opts.highlightTitle = m_oSearchConds.arrInclude;\n        opts.highlightContent = m_oSearchConds.arrInclude;\n      }\n      else if(\"article-title\" == m_oSearchConds.sScope)\n      {\n        opts.highlightTitle = m_oSearchConds.arrInclude;\n      }\n      else if(\"article-content\" == m_oSearchConds.sScope)\n      {\n        opts.highlightContent = m_oSearchConds.arrInclude;\n      }\n      article.show($container.children(\".article-block:last\"), opts);\n\n      if( m_nMatchedArticle >= m_nMaxMatchArticle || (m_nTotalArticle > 0 && m_nLoadedArticle >= m_nTotalArticle) )\n      {\n        showProgress();\n        return;\n      }\n    }  // for\n\n    showProgress();\n    delayRun(function(){ loadArticles(sTaskId, nIndex+json.feed.entry.length) }, 100);\n  }  // procArticles() end\n\n  function loadComments(sTaskId, dtMax)\n  {\n    var sFeedUrl = Url.getFeedUrlPrefix() + \"/comments/full?alt=json\"\n                 + \"&max-results=300\" + \"&published-max=\" + dtMax.toISOString();\n    m_oSearchConds.dtMin && (sFeedUrl += \"&published-min=\" + m_oSearchConds.dtMin.toISOString());\n\n    $.ajax({\n      url: sFeedUrl,\n      dataType: \"json\",\n      success: function(json) { procComments(sTaskId, json) },\n      error: function(xhr, sType) { reportHttpError(\"搜索出错\", xhr, sType) },\n      timeout: 1000*64\n    });\n  }\n\n  function matchComment(comment)\n  {\n    if(\"comment-author-url\" == m_oSearchConds.sScope)\n    {\n      return comment.oAuthor.isLogined()\n        ? ( m_oSearchConds.arrInclude\n            && m_oSearchConds.arrInclude[0] == comment.oAuthor.sHomeUrl )\n        : false;\n    }\n\n    var str = \"\";\n    if(\"all\" == m_oSearchConds.sScope)\n    {\n      str = comment.sText + \"\\n\" + comment.oAuthor.sName + \"\\n\" + comment.oAuthor.sHomeUrl;\n    }\n    else if(\"comment-content\" == m_oSearchConds.sScope)\n    {\n      str = comment.sText;\n    }\n    else if(\"comment-author\" == m_oSearchConds.sScope)\n    {\n      str = comment.oAuthor.sName;\n    }\n\n    for(var i=0; i<m_oSearchConds.arrInclude.length; i++)\n    {\n      var regex = keywordToRegexp(m_oSearchConds.arrInclude[i]);\n      if(str.search(regex) == -1) { return false }\n    }\n\n    for(var i=0; i<m_oSearchConds.arrExclude.length; i++)\n    {\n      var regex = keywordToRegexp(m_oSearchConds.arrExclude[i]);\n      if(str.search(regex) != -1) { return false }\n    }\n\n    return true;\n  }  // matchComment() end\n\n  function procComments(sTaskId, json)\n  {\n    if(m_sCommentTaskId != sTaskId) { return }  // User canceled\n    if(!(\"entry\" in json.feed))  // Not more data\n    {\n      m_sCommentTaskId = \"\";\n      (m_oSearchConds.sScope.startsWith(\"comment\") || \"all\"==m_oSearchConds.sScope) && stopSearch(false);\n      return;\n    }\n\n    (0 == m_nTotalComment) && (m_nTotalComment = parseInt(json.feed.openSearch$totalResults.$t));\n\n    var $admin_comments = $(\"#search-results .admin-comments\"), $reader_comments = $(\"#search-results .reader-comments\");\n    var nMinTime = null;\n    for(var n=0; n<json.feed.entry.length; n++)\n    {\n      var comment = new Comment(json.feed.entry[n]);\n      if(comment.bIsDeleted || !comment.nId) { continue }\n      nMinTime = comment.nId;\n\n      m_nLoadedComment += 1;\n      if(!matchComment(comment)) { continue }\n      m_nMatchedComment += 1;\n\n      var opts =\n      {\n        scope: m_oSearchConds.sScope,\n        keywords: m_oSearchConds.arrInclude,\n        maxTextLen: 300,\n        columnWidth: 125,\n        maxLineNum: 25,\n        maxAuthorLen: 30\n      };\n      if(\"all\" == m_oSearchConds.sScope)\n      {\n        opts.highlightText = m_oSearchConds.arrInclude;\n        opts.highlightAuthor = m_oSearchConds.arrInclude;\n      }\n      else if(\"comment-content\" == m_oSearchConds.sScope)\n      {\n        opts.highlightText = m_oSearchConds.arrInclude;\n      }\n      else if(\"comment-author\" == m_oSearchConds.sScope)\n      {\n        opts.highlightAuthor = m_oSearchConds.arrInclude;\n      }\n      else if(\"comment-author-url\" == m_oSearchConds.sScope)\n      {\n        opts.highlightAuthor = [comment.oAuthor.sName];\n      }\n\n      var $container = (comment.oAuthor.isAdmin() ? $admin_comments : $reader_comments);\n      var $comment_block = comment.showSummary(opts);\n      $container.append($comment_block.addClass(\"comment-block\"));\n\n      if( m_nMatchedComment >= m_nMaxMatchComment || (m_nTotalComment>0 && m_nLoadedComment>=m_nTotalComment) )\n      {\n        showProgress();\n        return;\n      }\n    }  // for\n\n    showProgress();\n    delayRun(function(){ loadComments(sTaskId, new Date(nMinTime-1)) }, 100);\n  }  // procComments() end\n\n  function showProgress()\n  {\n    var $message = $(\"#search-message\"), $loading = $(\"#search-loading\");\n    var $progress_bar = $loading.find(\"#progress-bar\"), $progress_label = $loading.find(\"#progress-label\");\n    var nArticlePercent = 0;\n\n    if(m_oSearchConds.sScope.match(/^all|^article/))\n    {\n      if(\"\" == m_sArticleTaskId)\n      {\n        nArticlePercent = 100;\n      }\n      else if(m_nTotalArticle > 0)\n      {\n        var nPercent1 = 100 * m_nLoadedArticle / m_nTotalArticle;\n        var nPercent2 = 100 * m_nMatchedArticle / m_nMaxMatchArticle;\n        nArticlePercent = Math.max(nPercent1, nPercent2);\n      }\n\n      $message.children(\".article\").html(\n        \"正在进行“博文搜索”...... \"\n        + (m_nMatchedArticle ? \"已经找到 \" + m_nMatchedArticle + \" 篇匹配的博文\" : \"\")\n      );\n    }\n\n    var nCommentPercent = 0;\n    if(m_oSearchConds.sScope.match(/^all|^comment/))\n    {\n      if(\"\" == m_sCommentTaskId)\n      {\n        nCommentPercent = 100;\n      }\n      else if(m_nTotalComment > 0)\n      {\n        var nPercent1 = 100 * m_nLoadedComment / m_nTotalComment;\n        var nPercent2 = 100 * m_nMatchedComment / m_nMaxMatchComment;\n        nCommentPercent = Math.max(nPercent1, nPercent2);\n      }\n      $message.children(\".comment\").html(\n        \"正在进行“评论搜索”...... \"\n        + (m_nMatchedComment ? \"已经找到 \" + m_nMatchedComment + \" 条匹配的评论\" : \"\")\n      );\n    }\n\n    var nPercent = 0;\n    if(\"all\" == m_oSearchConds.sScope) { nPercent = (nArticlePercent + nCommentPercent * 9) / 10 }\n    else if(m_oSearchConds.sScope.match(/^article/)) { nPercent = nArticlePercent }\n    else if(m_oSearchConds.sScope.match(/^comment/)) { nPercent = nCommentPercent }\n\n    $progress_bar.progressbar({value: nPercent});\n    $progress_label.html(Math.round(nPercent) + \"%\");\n    (100 == nPercent) && stopSearch(false);\n  }  // showProgress() end\n\n  function stopSearch(bCanceled)\n  {\n    m_sArticleTaskId = \"\";\n    m_sCommentTaskId = \"\";\n\n    $(\"#start-search\").show();\n    $(\"#stop-search\").hide();\n    $(\"#search-loading\").hide();\n\n    var $message = $(\"#search-message\");\n    $message.children(\".complete\").html(bCanceled ? \"搜索已被用户中止\" : \"搜索已完成\");\n\n    if(m_oSearchConds.sScope.match(/^all|^article/))\n    {\n      var bMaxLimit = (m_nMatchedArticle >= m_nMaxMatchArticle);\n      $message.children(\".article\").html(\n        \"共找到博文 <b>\" + m_nMatchedArticle + \"</b> 篇\"\n        + (bMaxLimit ? \"　（输入的“搜索关键词”太宽松，已达到“博文搜索”的最大结果数）\" : \"\")\n      );\n    }\n    if(m_oSearchConds.sScope.match(/^all|^comment/))\n    {\n      var bMaxLimit = (m_nMatchedComment >= m_nMaxMatchComment);\n      $message.children(\".comment\").html(\n        \"共找到评论 <b>\" + m_nMatchedComment + \"</b> 条\"\n        + (bMaxLimit ? \"　（输入的“搜索关键词”太宽松，已达到“评论搜索”的最大结果数）\" : \"\")\n      );\n    }\n  }\n\n  function startSearch()\n  {\n    if(!parseKeywordCond() || !parseDateCond()) { return }\n\n    !m_nTotalArticle && initArticleTotal();\n    m_nLoadedArticle = 0;\n    m_nMatchedArticle = 0;\n\n    m_nTotalComment = 0;\n    m_nLoadedComment = 0;\n    m_nMatchedComment = 0;\n\n    if(\"all\" == m_oSearchConds.sScope)\n    {\n      m_sArticleTaskId = (\"\" + Math.random()).substr(2);\n      loadArticles(m_sArticleTaskId, 1);\n\n      m_sCommentTaskId = (\"\" + Math.random()).substr(2);\n      loadComments(m_sCommentTaskId, m_oSearchConds.dtMax);\n    }\n    else if(m_oSearchConds.sScope.startsWith(\"article\"))\n    {\n      m_sArticleTaskId = (\"\" + Math.random()).substr(2);\n      loadArticles(m_sArticleTaskId, 1);\n    }\n    else if(m_oSearchConds.sScope.startsWith(\"comment\"))\n    {\n      m_sCommentTaskId = (\"\" + Math.random()).substr(2);\n      loadComments(m_sCommentTaskId, m_oSearchConds.dtMax);\n    }\n\n    $(\"#start-search\").hide();\n    $(\"#stop-search\").show();\n    $(\"#search-results\").children(\"div\").html(\"\");\n\n    $(\"#search-message\").children(\"div\").html(\"\");\n    $(\"#search-loading\").show();\n    showProgress();\n  }  // startSearch() end\n\n  function initParams()\n  {\n    var oUrl = new Url(null);\n    $(\"#search-keywords\").val(oUrl.getParam(\"q\"));\n    $(\"#search-scope\").val(oUrl.getParam(\"scope\")).trigger(\"change\");\n\n    var sToday = (new Date()).format(\"%Y-%0m-%0d\");\n    $(\"#max-date\").datepicker().val(sToday);\n    $(\"#min-date\").datepicker().val(sToday);\n\n    oUrl.getParam(\"q\") && startSearch();\n  }\n\n  function init()\n  {\n    Comment.initArticlesMap(32);\n    initArticleTotal();\n\n    $(\"#search-keywords\").keypress(\n      function(event){ 13 == event.keyCode && $(\"#start-search\").is(\":visible\") && startSearch() }\n    ).tooltip({\n      open: function(event, ui){ delayRun(function(){ $(ui.tooltip).hide(\"fade\") }, 5000) }\n    });\n\n    $(\"#search-scope\").change(\n      function()\n      {\n        m_oSearchConds.sScope = $(this).val();\n        $(\"#keywords-tip\").html(\n          \"comment-author-url\" == m_oSearchConds.sScope\n            ? \"搜索“评论作者网址”时，“搜索关键词”必须是【单个】网址<\"\n              + \"br>并且以 http:// 或 https:// 开头\"\n            : \"如果同时入多个关键词，用空格分开<\"\n              + \"br>关键词<b>只能包含</b>：汉字 英文字母 数字 下划线 小数点 空格<\"\n              + \"br>某关键词如果含空格，用<b>引号</b>引用之（否则被视作多个关键字）<\"\n              + \"br>关键词加<b>减号</b>作前缀，表示“搜索结果【不包含】该关键词”\"\n        );\n      }\n    );\n\n    $(\"#start-search\").click(startSearch);\n    $(\"#stop-search\").click(function() { stopSearch(true) });\n    $(\"#min-date\").datepicker(getDatePickerOpts());\n    $(\"#max-date\").datepicker(getDatePickerOpts());\n    $(\"#search-conditions\").show();\n    initParams();\n  }  // init() end\n\n  $(document).ready(\n    function()\n    {\n      try { init() }\n      catch(err) { reportError(\"init: Catch exception:\\n\" + err) }\n    }\n  );\n});\n</script>","author":{"id":"11741356469378252621","displayName":"编程随想","url":"https://www.blogger.com/profile/11741356469378252621","image":{"url":"//1.bp.blogspot.com/-_5va5DafROs/VtcrFXMaY_I/AAAAAAAABU4/lQWoB9z4jaI/s35/Thinker.jpg"}},"etag":"\"dGltZXN0YW1wOiAxNTQ2MzIwNzUyNDUwCm9mZnNldDogMjg4MDAwMDAK\""},{"kind":"blogger#page","id":"5321670274374950003","blog":{"id":"5235590154125226279"},"published":"2014-10-13T20:09:00+08:00","updated":"2014-10-13T20:09:30+08:00","url":"http://program-think.blogspot.com/p/configure.html","selfLink":"https://www.googleapis.com/blogger/v3/blogs/5235590154125226279/pages/5321670274374950003","title":"configure","content":"","author":{"id":"11741356469378252621","displayName":"编程随想","url":"https://www.blogger.com/profile/11741356469378252621","image":{"url":"//1.bp.blogspot.com/-_5va5DafROs/VtcrFXMaY_I/AAAAAAAABU4/lQWoB9z4jaI/s35/Thinker.jpg"}},"etag":"\"dGltZXN0YW1wOiAxNDEzMjAyMTcwMTYwCm9mZnNldDogMjg4MDAwMDAK\""}],"etag":"\"MjAyMS0wNS0xMFQwOTo1OTo0NC4zNTRa\""}]